<c-card class="error-container" *ngIf="showErrorState" style="margin-bottom: 1rem;">
  <div class="text-area">
      <p>{{ errorText }}</p>
  </div>
</c-card>

<c-card class="mb-4">
  <c-card-body>
    <div class="row" style="display: flex; align-items: center;" *ngIf="transcriptIsLoading">
      <c-spinner color="info" style="margin-top: 1rem; margin-left: 1rem;"></c-spinner>
      <p style="margin-top: 1rem;" class="text-medium-emphasis">
        Your script is loading...
      </p>
    </div>

    <mat-horizontal-stepper [linear]="true" #stepper>

      <mat-step [stepControl]="scriptFormGroup" *ngIf="!transcriptIsLoading">
      <h4>Your Script Is Ready</h4>
        <p class="text-medium-emphasis" style="padding-right: 1rem;;">
          Customize your script by editing and rearranging the script sections. Enhance the quality with our AI tools, taking as much time as you need.  When you are finished we will review your video title and description.
        </p>
        <ng-template matStepLabel>Edit</ng-template>
        <div cdkDropList (cdkDropListDropped)="onDrop($event)">
          <div cdkDrag cdkDragLockAxis="y" *ngFor="let tran of transcriptSections; let i = index" class="row" style="margin-top: 1rem; margin-bottom: 1rem;">
          <div class="col-8">
            <div class="text-container" style="display: flex; justify-content: space-between; flex-direction: row;">
              <div cdkDragHandle>
                <svg cIcon name="cilApps" style="margin-top: 0.75rem;"></svg>
              </div>
              <textarea autosize cFormControl [(ngModel)]="transcriptSections[i]"></textarea>
            </div>
          </div>
          <div class="col-1">
            <div style="display: flex; align-items: center; padding: 0; margin:0">
              <c-button-group>
                <c-dropdown #dropdown direction="dropstart" variant="input-group">
                  <ul cDropdownMenu>
                    <li><button cDropdownItem>Funnier</button></li>
                    <li><button cDropdownItem>More Formal</button></li>
                    <li><button cDropdownItem>Simpler</button></li>
                    <li><button cDropdownItem>Make Longer</button></li>
                    <li><button cDropdownItem>Shorten</button></li>
                    <li><hr cDropdownDivider></li>
                    <li><button cDropdownItem>Close</button></li>
                  </ul>
                  <button cButton cDropdownToggle class="col-btn" variant="outline" color="dark" [disabled]="transcriptIsLoading" style="margin-right: 0px;"
                    (click)="onImproveClick('funny', transcriptSections[i])">
                    <c-spinner *ngIf="transcriptIsLoading" size="sm"></c-spinner>
                    Use AI
                  </button>
                </c-dropdown>
              </c-button-group>
            </div>
          </div>
        </div>
        </div>
        <div class="d-flex justify-content-end align-items-center full-width" style="margin-top: 2rem; ">
          <button variant="outline" color="dark" cButton>Need Help?</button>
          <button class="btn btn-primary" style="margin-left: 1rem;" matStepperNext (onClick)="onScriptSubmit()">
            Next Step
          </button>
        </div>
      </mat-step>
    </mat-horizontal-stepper>
  </c-card-body>
</c-card>